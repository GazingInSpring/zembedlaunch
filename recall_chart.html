<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recall@K — zembed-1 vs Competitors</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        background: #fafafa;
        padding: 40px 20px;
    }
    .container {
        max-width: 960px;
        margin: 0 auto;
        background: white;
        border-radius: 16px;
        border: 1px solid #e5e5e5;
        box-shadow: 0 4px 24px rgba(0,0,0,0.06);
        padding: 32px 40px;
    }
    h2 {
        font-size: 22px;
        font-weight: 700;
        letter-spacing: -0.02em;
        margin-bottom: 4px;
    }
    .subtitle {
        font-size: 14px;
        color: #888;
        margin-bottom: 24px;
    }
    .chart-wrap {
        position: relative;
        height: 480px;
    }
    .controls {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 20px;
        flex-wrap: wrap;
    }
    .controls label {
        font-size: 13px;
        font-weight: 600;
        color: #555;
    }
    .controls select {
        padding: 6px 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 13px;
        font-family: inherit;
        background: #fafafa;
    }
    .controls select:focus {
        outline: none;
        border-color: #4f46e5;
    }
    .mode-btn {
        padding: 6px 16px;
        border: 1px solid #ddd;
        border-radius: 6px;
        font-size: 13px;
        font-family: inherit;
        background: #fafafa;
        cursor: pointer;
        transition: all 0.15s;
    }
    .mode-btn:hover {
        background: #f0f0f0;
    }
    .mode-btn.active {
        background: #4f46e5;
        color: white;
        border-color: #4f46e5;
    }

    /* Title sections */
    .title-absolute, .title-delta {
        transition: opacity 0.3s, transform 0.3s;
    }
    .title-absolute.hidden, .title-delta.hidden {
        display: none;
    }

    /* Rotating word animation */
    .delta-title {
        font-size: 22px;
        font-weight: 700;
        letter-spacing: -0.02em;
        margin-bottom: 4px;
    }
    .word-rotator {
        display: inline-block;
        height: 1.3em;
        overflow: hidden;
        vertical-align: bottom;
        position: relative;
        min-width: 80px;
        text-align: center;
    }
    .word-rotator .word {
        display: block;
        height: 1.3em;
        line-height: 1.3em;
        font-weight: 800;
        position: absolute;
        width: 100%;
        left: 0;
        transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                    opacity 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .word-rotator .word.worse {
        color: #dc2626;
    }
    .word-rotator .word.better {
        color: #059669;
    }
    /* States: visible, exiting-down, entering-from-top */
    .word-rotator .word.state-visible {
        transform: translateY(0);
        opacity: 1;
    }
    .word-rotator .word.state-exit {
        transform: translateY(110%);
        opacity: 0;
    }
    .word-rotator .word.state-above {
        transform: translateY(-110%);
        opacity: 0;
        transition: none; /* snap to top instantly */
    }

    .baseline-name {
        color: #4f46e5;
        font-weight: 800;
        font-style: italic;
    }
    

    /* Y-range flash indicator */
    .range-flash {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
        border-radius: 8px;
        z-index: 10;
        opacity: 0;
        transition: opacity 0.15s;
    }
    .range-flash.active {
        opacity: 1;
        animation: flashPulse 0.6s ease-out forwards;
    }
    @keyframes flashPulse {
        0% {
            box-shadow: inset 0 0 0 3px rgba(79, 70, 229, 0.5);
            opacity: 1;
        }
        100% {
            box-shadow: inset 0 0 0 0px rgba(79, 70, 229, 0);
            opacity: 0;
        }
    }

    /* Range badge */
    .range-badge {
        position: absolute;
        top: 8px;
        right: 8px;
        background: #4f46e5;
        color: white;
        font-size: 11px;
        font-weight: 600;
        padding: 4px 10px;
        border-radius: 4px;
        z-index: 11;
        opacity: 0;
        transform: translateY(-8px);
        transition: opacity 0.25s, transform 0.25s;
        pointer-events: none;
    }
    .range-badge.visible {
        opacity: 1;
        transform: translateY(0);
    }
</style>
</head>
<body>
<div class="container">
    <div class="title-absolute" id="titleAbsolute">
        <h2>Recall@K</h2>
        <p class="subtitle">Higher is better. Evaluated on ZeroEntropy internal benchmarks.</p>
    </div>
    <div class="title-delta hidden" id="titleDelta">
        <div class="delta-title">
            Which models are
            <span class="word-rotator" id="wordRotator">
                <span class="word worse state-visible" id="wordA">worse</span>
                <span class="word better state-above" id="wordB">better</span>
            </span>
            than
            <span class="baseline-name" id="baselineLabel"></span>?
        </div>
        <p class="subtitle">Δ Recall@K vs baseline. Above zero = better.</p>
    </div>
    <div class="controls">
        <button class="mode-btn active" id="btnAbsolute" onclick="setMode('absolute')">Absolute</button>
        <button class="mode-btn" id="btnDelta" onclick="setMode('delta')">Δ vs Baseline</button>
        <div id="baselineControl" style="display:none;">
            <label>Baseline: </label>
            <select id="baselineSelect" onchange="onBaselineChange()"></select>
        </div>
    </div>
    <div class="chart-wrap">
        <canvas id="recallChart"></canvas>
        <div class="range-flash" id="rangeFlash"></div>
        <div class="range-badge" id="rangeBadge"></div>
    </div>
</div>
<script>
const RAW_DATA = {"labels": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100], "datasets": [{"label": "Qwen3-Embedding-4B", "data": [0.06697, 0.11129, 0.14799, 0.17646, 0.20305, 0.22831, 0.24787, 0.26657, 0.28279, 0.29925, 0.31376, 0.32637, 0.3415, 0.3525, 0.36181, 0.37328, 0.38237, 0.39178, 0.4015, 0.41151, 0.42066, 0.42989, 0.43723, 0.44346, 0.45049, 0.45665, 0.46291, 0.46925, 0.47622, 0.48193, 0.48752, 0.49262, 0.49707, 0.50217, 0.50684, 0.51101, 0.51518, 0.51921, 0.52242, 0.52725, 0.53152, 0.53472, 0.53894, 0.54186, 0.54579, 0.54988, 0.55346, 0.55664, 0.55957, 0.56253, 0.56477, 0.56747, 0.56996, 0.57266, 0.57656, 0.58017, 0.58288, 0.58551, 0.58759, 0.5919, 0.59494, 0.59732, 0.60033, 0.60295, 0.60536, 0.60728, 0.61117, 0.61281, 0.61509, 0.61731, 0.61888, 0.62155, 0.62345, 0.62574, 0.62758, 0.62937, 0.63098, 0.63314, 0.63509, 0.63658, 0.63864, 0.64059, 0.64156, 0.64303, 0.64483, 0.64623, 0.64837, 0.65076, 0.65299, 0.65457, 0.65598, 0.65746, 0.65863, 0.65988, 0.66149, 0.66341, 0.66475, 0.66636, 0.66775, 0.66905], "borderColor": "#ff7d59", "borderWidth": 2, "pointRadius": 0, "tension": 0.3}, {"label": "zembed-1", "data": [0.07432, 0.11991, 0.1569, 0.19005, 0.21845, 0.24193, 0.26247, 0.28404, 0.30216, 0.31819, 0.33332, 0.34752, 0.36052, 0.37331, 0.38536, 0.39702, 0.40796, 0.41847, 0.42833, 0.4374, 0.4479, 0.45637, 0.46471, 0.47143, 0.47803, 0.48402, 0.49008, 0.49667, 0.50337, 0.50871, 0.51507, 0.52131, 0.52687, 0.53186, 0.53832, 0.54176, 0.54536, 0.55015, 0.55422, 0.55769, 0.56234, 0.56601, 0.56899, 0.57305, 0.57638, 0.57968, 0.58341, 0.58704, 0.59036, 0.59458, 0.59732, 0.60027, 0.60448, 0.60725, 0.61031, 0.61334, 0.61672, 0.62019, 0.62271, 0.62524, 0.62819, 0.63077, 0.63301, 0.63549, 0.63795, 0.64024, 0.64206, 0.6436, 0.64531, 0.64818, 0.65018, 0.65234, 0.65427, 0.65595, 0.65747, 0.65979, 0.66166, 0.66461, 0.66738, 0.66866, 0.67068, 0.67294, 0.67469, 0.6771, 0.67861, 0.68072, 0.68259, 0.68388, 0.68593, 0.68765, 0.68891, 0.69072, 0.69256, 0.69438, 0.69589, 0.69717, 0.69945, 0.70065, 0.70205, 0.70387], "borderColor": "#4f46e5", "borderWidth": 2, "pointRadius": 0, "tension": 0.3}, {"label": "Voyage 4", "data": [0.06552, 0.11047, 0.14713, 0.18214, 0.20847, 0.23352, 0.25545, 0.2778, 0.29755, 0.31541, 0.32955, 0.34344, 0.35488, 0.36702, 0.37848, 0.39, 0.40018, 0.40934, 0.41965, 0.42886, 0.43897, 0.44618, 0.45463, 0.46125, 0.46798, 0.47533, 0.48293, 0.48993, 0.49608, 0.50216, 0.50766, 0.51377, 0.52007, 0.52517, 0.53137, 0.53619, 0.54022, 0.54494, 0.54906, 0.5528, 0.55736, 0.5612, 0.56616, 0.5701, 0.57319, 0.57766, 0.58194, 0.58574, 0.59177, 0.59533, 0.59867, 0.60195, 0.60465, 0.60751, 0.61154, 0.61501, 0.61792, 0.62049, 0.62411, 0.6268, 0.6292, 0.63243, 0.63432, 0.6368, 0.63982, 0.64254, 0.64516, 0.64723, 0.64925, 0.65141, 0.65371, 0.656, 0.65809, 0.65968, 0.66295, 0.66578, 0.66791, 0.66902, 0.67123, 0.67341, 0.67512, 0.67726, 0.68011, 0.68163, 0.68394, 0.68651, 0.68814, 0.69062, 0.69271, 0.69406, 0.69685, 0.69851, 0.69988, 0.70073, 0.7023, 0.70358, 0.70509, 0.70688, 0.7086, 0.70976], "borderColor": "#6366f1", "borderWidth": 2, "pointRadius": 0, "tension": 0.3}, {"label": "Voyage 4 Nano", "data": [0.05638, 0.09675, 0.13112, 0.16021, 0.18599, 0.20369, 0.22397, 0.24121, 0.26075, 0.27791, 0.29193, 0.30417, 0.31532, 0.32813, 0.33751, 0.34837, 0.35963, 0.3692, 0.38091, 0.38854, 0.39687, 0.40569, 0.41239, 0.41897, 0.42692, 0.43429, 0.44101, 0.44728, 0.45281, 0.45875, 0.46393, 0.46922, 0.47464, 0.47979, 0.48357, 0.48772, 0.49389, 0.498, 0.50268, 0.50669, 0.51034, 0.51408, 0.51922, 0.52304, 0.52699, 0.53137, 0.53465, 0.53838, 0.54269, 0.54611, 0.5487, 0.55218, 0.55426, 0.55698, 0.55997, 0.56265, 0.5655, 0.56886, 0.57079, 0.57336, 0.5768, 0.57969, 0.58215, 0.58493, 0.58872, 0.59067, 0.59376, 0.59665, 0.59907, 0.60187, 0.60401, 0.60618, 0.60878, 0.61073, 0.61288, 0.615, 0.61718, 0.62007, 0.62258, 0.62486, 0.62695, 0.62867, 0.63128, 0.63338, 0.63581, 0.63738, 0.63931, 0.64115, 0.64202, 0.64346, 0.64533, 0.64695, 0.64859, 0.65007, 0.65156, 0.65318, 0.65467, 0.6567, 0.65802, 0.65975], "borderColor": "#a78bfa", "borderWidth": 2, "pointRadius": 0, "tension": 0.3}, {"label": "OpenAI text-embedding-3-large", "data": [0.05532, 0.09518, 0.129, 0.15517, 0.1812, 0.20393, 0.22331, 0.24021, 0.25679, 0.27221, 0.2849, 0.29719, 0.31016, 0.32124, 0.33188, 0.34084, 0.35038, 0.36152, 0.37167, 0.38108, 0.38965, 0.39687, 0.40391, 0.41159, 0.41788, 0.42556, 0.432, 0.43706, 0.44259, 0.44823, 0.45396, 0.46013, 0.46462, 0.47109, 0.47491, 0.48086, 0.48476, 0.48911, 0.49337, 0.49779, 0.50228, 0.50722, 0.51235, 0.5163, 0.5192, 0.52309, 0.52665, 0.53082, 0.53506, 0.5378, 0.54171, 0.54441, 0.54807, 0.55063, 0.55318, 0.55619, 0.5592, 0.56154, 0.56499, 0.5676, 0.57099, 0.57377, 0.57674, 0.57922, 0.58205, 0.58475, 0.58774, 0.5903, 0.59217, 0.59511, 0.59705, 0.5992, 0.60046, 0.60352, 0.60581, 0.6074, 0.60917, 0.61086, 0.61327, 0.61494, 0.61659, 0.61822, 0.62041, 0.62221, 0.62411, 0.62659, 0.62851, 0.63038, 0.63262, 0.63453, 0.63577, 0.63698, 0.6384, 0.64056, 0.64211, 0.64338, 0.64418, 0.64555, 0.64762, 0.64892], "borderColor": "#10a37f", "borderWidth": 2, "pointRadius": 0, "tension": 0.3}, {"label": "OpenAI text-embedding-3-small", "data": [0.05151, 0.08477, 0.11496, 0.13818, 0.15794, 0.17541, 0.19028, 0.2078, 0.22551, 0.23862, 0.25051, 0.26262, 0.27486, 0.28456, 0.29497, 0.30403, 0.31223, 0.32165, 0.33063, 0.33895, 0.34642, 0.35292, 0.36058, 0.36648, 0.37338, 0.3785, 0.38443, 0.38978, 0.39519, 0.40102, 0.40625, 0.4118, 0.41791, 0.42192, 0.4269, 0.43143, 0.43509, 0.44027, 0.44571, 0.44948, 0.4536, 0.45679, 0.46053, 0.46442, 0.46803, 0.47084, 0.47447, 0.47794, 0.48129, 0.48477, 0.48774, 0.49114, 0.49541, 0.49827, 0.50135, 0.50404, 0.50718, 0.50942, 0.51144, 0.51341, 0.51588, 0.51775, 0.51942, 0.52245, 0.52522, 0.52687, 0.52903, 0.53198, 0.53416, 0.5364, 0.53918, 0.54167, 0.54366, 0.54623, 0.54847, 0.5503, 0.55218, 0.55402, 0.5554, 0.55704, 0.55932, 0.56151, 0.56352, 0.56528, 0.56747, 0.56988, 0.57274, 0.57414, 0.57644, 0.57815, 0.57944, 0.58158, 0.5836, 0.58476, 0.58689, 0.58874, 0.59046, 0.59338, 0.59558, 0.59779], "borderColor": "#6ee7b7", "borderWidth": 2, "pointRadius": 0, "tension": 0.3}]};
const originalDatasets = RAW_DATA.datasets.map(d => ({ ...d, data: [...d.data] }));

let mode = 'absolute';
let chart;
let rotatorInterval = null;
let currentWord = 0; // 0 = worse showing, 1 = better showing
let prevYMin = 0;
let prevYMax = 1;

function initBaselineSelect() {
    const sel = document.getElementById('baselineSelect');
    originalDatasets.forEach((d, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = d.label;
        sel.appendChild(opt);
    });
}

function startRotator() {
    stopRotator();
    currentWord = 0;
    const wordA = document.getElementById('wordA');
    const wordB = document.getElementById('wordB');
    wordA.className = 'word worse state-visible';
    wordB.className = 'word better state-above';

    rotatorInterval = setInterval(() => {
        if (currentWord === 0) {
            // worse exits down, better enters from top
            wordA.className = 'word worse state-exit';
            wordB.className = 'word better state-above';
            // After snap-to-top (no transition), trigger enter
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    wordB.className = 'word better state-visible';
                });
            });
            currentWord = 1;
        } else {
            // better exits down, worse enters from top
            wordB.className = 'word better state-exit';
            wordA.className = 'word worse state-above';
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    wordA.className = 'word worse state-visible';
                });
            });
            currentWord = 0;
        }
    }, 2200);
}

function stopRotator() {
    if (rotatorInterval) {
        clearInterval(rotatorInterval);
        rotatorInterval = null;
    }
}

function flashRange(newMin, newMax) {
    // Flash border
    const flash = document.getElementById('rangeFlash');
    flash.classList.remove('active');
    void flash.offsetWidth; // force reflow
    flash.classList.add('active');

    // Show badge with new range
    const badge = document.getElementById('rangeBadge');
    const minStr = newMin >= 0 ? '+' + newMin.toFixed(3) : newMin.toFixed(3);
    const maxStr = newMax >= 0 ? '+' + newMax.toFixed(3) : newMax.toFixed(3);
    badge.textContent = 'y: [' + newMin.toFixed(3) + ', ' + newMax.toFixed(3) + ']';
    badge.classList.add('visible');

    setTimeout(() => {
        badge.classList.remove('visible');
    }, 1500);
}

function setMode(m) {
    mode = m;
    document.getElementById('btnAbsolute').classList.toggle('active', m === 'absolute');
    document.getElementById('btnDelta').classList.toggle('active', m === 'delta');
    document.getElementById('baselineControl').style.display = m === 'delta' ? '' : 'none';

    document.getElementById('titleAbsolute').classList.toggle('hidden', m !== 'absolute');
    document.getElementById('titleDelta').classList.toggle('hidden', m !== 'delta');

    if (m === 'delta') {
        startRotator();
    } else {
        stopRotator();
    }

    updateChart();
}

function onBaselineChange() {
    updateChart();
}

function updateChart() {
    const baseIdx = parseInt(document.getElementById('baselineSelect').value);
    const baseData = originalDatasets[baseIdx].data;

    document.getElementById('baselineLabel').textContent = originalDatasets[baseIdx].label;

    if (mode === 'delta') {
        let globalMin = 0;
        let globalMax = 0;
        chart.data.datasets.forEach((ds, i) => {
            const deltas = originalDatasets[i].data.map((v, k) => Math.round((v - baseData[k]) * 100000) / 100000);
            ds.data = deltas;
            ds.hidden = false;
            if (i === baseIdx) {
                // Baseline is the zero line — show it styled as reference
                ds.borderWidth = 3;
                ds.borderDash = [6, 4];
                ds.borderColor = originalDatasets[i].borderColor;
            } else {
                ds.borderWidth = 2;
                ds.borderDash = [];
                ds.borderColor = originalDatasets[i].borderColor;
                const lo = Math.min(...deltas);
                const hi = Math.max(...deltas);
                if (lo < globalMin) globalMin = lo;
                if (hi > globalMax) globalMax = hi;
            }
        });

        // Pad range by 10%
        const range = globalMax - globalMin || 0.01;
        const newMin = Math.floor((globalMin - range * 0.1) * 1000) / 1000;
        const newMax = Math.ceil((globalMax + range * 0.1) * 1000) / 1000;

        // Flash if range changed meaningfully
        if (Math.abs(newMin - prevYMin) > 0.001 || Math.abs(newMax - prevYMax) > 0.001) {
            flashRange(newMin, newMax);
        }

        chart.options.scales.y.min = newMin;
        chart.options.scales.y.max = newMax;
        chart.options.scales.y.title.text = 'Δ Recall@K';
        prevYMin = newMin;
        prevYMax = newMax;
    } else {
        chart.data.datasets.forEach((ds, i) => {
            ds.data = [...originalDatasets[i].data];
            ds.hidden = false;
            ds.borderWidth = 2;
            ds.borderDash = [];
            ds.borderColor = originalDatasets[i].borderColor;
        });
        chart.options.scales.y.min = 0;
        chart.options.scales.y.max = 1;
        chart.options.scales.y.title.text = 'Recall@K';
        prevYMin = 0;
        prevYMax = 1;
    }

    chart.update();
}

initBaselineSelect();

const ctx = document.getElementById('recallChart').getContext('2d');
chart = new Chart(ctx, {
    type: 'line',
    data: JSON.parse(JSON.stringify(RAW_DATA)),
    options: {
        responsive: true,
        maintainAspectRatio: false,
        animation: {
            duration: 600,
            easing: 'easeInOutCubic',
        },
        transitions: {
            active: {
                animation: {
                    duration: 300,
                }
            }
        },
        interaction: {
            mode: 'index',
            intersect: false,
        },
        plugins: {
            legend: {
                position: 'bottom',
                labels: {
                    usePointStyle: true,
                    pointStyle: 'line',
                    padding: 20,
                    font: { size: 13 },
                },
            },
            tooltip: {
                itemSort: function(a, b) {
                    return b.parsed.y - a.parsed.y;
                },
                callbacks: {
                    title: function(items) {
                        return 'K = ' + items[0].label;
                    },
                    label: function(item) {
                        const prefix = mode === 'delta' ? (item.parsed.y >= 0 ? '+' : '') : '';
                        return item.dataset.label + ': ' + prefix + item.parsed.y.toFixed(4);
                    },
                },
            },
        },
        scales: {
            x: {
                title: { display: true, text: 'K', font: { size: 13 } },
                ticks: {
                    callback: function(val, idx) {
                        const v = idx + 1;
                        if (v === 1 || v % 10 === 0) return v;
                        return '';
                    },
                },
            },
            y: {
                title: { display: true, text: 'Recall@K', font: { size: 13 } },
                min: 0,
                max: 1,
            },
        },
    },
});
</script>
</body>
</html>